window.__require=function t(e,o,i){function n(s,a){if(!o[s]){if(!e[s]){var d=s.split("/");if(d=d[d.length-1],!e[d]){var p="function"==typeof __require&&__require;if(!a&&p)return p(d,!0);if(c)return c(d,!0);throw new Error("Cannot find module '"+s+"'")}s=d}var u=o[s]={exports:{}};e[s][0].call(u.exports,function(t){return n(e[s][1][t]||t)},u,u.exports,t,e,o,i)}return o[s].exports}for(var c="function"==typeof __require&&__require,s=0;s<i.length;s++)n(i[s]);return n}({JoystickEnum:[function(t,e,o){"use strict";cc._RF.push(e,"8b5a5Re7qpJIKGtGrt4O6rv","JoystickEnum"),o.__esModule=!0,o.default=void 0;var i={JoystickType:cc.Enum({FIXED:0,FOLLOW:1}),DirectionType:cc.Enum({FOUR:4,EIGHT:8,ALL:0}),SpeedType:cc.Enum({STOP:0,NORMAL:1,FAST:2}),JoystickEventType:cc.Enum({TOUCH_START:"touchStart",TOUCH_MOVE:"touchMove",TOUCH_END:"touchEnd",CHANGE_JOYSTICK_TYPE:"changeJoystickType"})};o.default=i,e.exports=o.default,cc._RF.pop()},{}],JoystickEvent:[function(t,e,o){"use strict";cc._RF.push(e,"ba937pp7tZKTLKCnDZAsStd","JoystickEvent"),o.__esModule=!0,o.default=void 0;var i=cc.Class({properties:{_event:null},ctor:function(){this._event=new cc.EventTarget},on:function(t,e,o){this._event.on(t,e,o)},off:function(t,e,o){this._event.off(t,e,o)},emit:function(t){for(var e,o=arguments.length,i=new Array(o>1?o-1:0),n=1;n<o;n++)i[n-1]=arguments[n];(e=this._event).emit.apply(e,[t].concat(i))}}),n=null;i.getInstance=function(){return!n&&(n=new i),n};var c=i;o.default=c,e.exports=o.default,cc._RF.pop()},{}],Joystick:[function(t,e){"use strict";cc._RF.push(e,"2a5f4A6L4lFJKWrb0ereNkY","Joystick");var o=n(t("JoystickEnum")),i=n(t("JoystickEvent"));function n(t){return t&&t.__esModule?t:{default:t}}cc.Class({extends:cc.Component,properties:{dot:{default:null,type:cc.Node,displayName:"Dot",tooltip:"\u6447\u6746\u64cd\u7eb5\u70b9"},ring:{default:null,type:cc.Node,displayName:"Ring",tooltip:"\u6447\u6746\u80cc\u666f\u8282\u70b9"},joystickType:{default:o.default.JoystickType.FIXED,type:o.default.JoystickType,displayName:"Touch Type",tooltip:"\u89e6\u6478\u7c7b\u578b"},directionType:{default:o.default.DirectionType.ALL,type:o.default.DirectionType,displayName:"Direction Type",tooltip:"\u65b9\u5411\u7c7b\u578b"},_stickPos:{default:null,type:cc.Node,tooltip:"\u6447\u6746\u6240\u5728\u4f4d\u7f6e"},_touchLocation:{default:null,type:cc.Node,tooltip:"\u89e6\u6478\u4f4d\u7f6e"}},onLoad:function(){this._radius=this.ring.width/2,this._initTouchEvent(),this.joystickType===o.default.JoystickType.FOLLOW&&(this.node.opacity=0)},onEnable:function(){i.default.getInstance().on(o.default.JoystickEventType.CHANGE_JOYSTICK_TYPE,this._onChangeJoystickType,this)},onDisable:function(){i.default.getInstance().off(o.default.JoystickEventType.CHANGE_JOYSTICK_TYPE,this._onChangeJoystickType,this)},_onChangeJoystickType:function(t){this.joystickType=t,this.node.opacity=t===o.default.JoystickType.FIXED?255:0},_initTouchEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._touchStartEvent,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._touchMoveEvent,this),this.node.on(cc.Node.EventType.TOUCH_END,this._touchEndEvent,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._touchEndEvent,this)},_touchStartEvent:function(t){i.default.getInstance().emit(o.default.JoystickEventType.TOUCH_START,"joystick touch start",10);var e=this.node.convertToNodeSpaceAR(t.getLocation());if(this.joystickType===o.default.JoystickType.FIXED){this._stickPos=this.ring.getPosition();var n=e.sub(this.ring.getPosition()).mag();this._radius>n&&this.dot.setPosition(e)}else this.joystickType===o.default.JoystickType.FOLLOW&&(this._stickPos=e,this.node.opacity=255,this._touchLocation=t.getLocation(),this.ring.setPosition(e),this.dot.setPosition(e))},_touchMoveEvent:function(t){if(this.joystickType===o.default.JoystickType.FOLLOW&&this._touchLocation===t.getLocation())return!1;var e,n=this.ring.convertToNodeSpaceAR(t.getLocation()),c=n.mag(),s=this._stickPos.x+n.x,a=this._stickPos.y+n.y,d=cc.v2(s,a).sub(this.ring.getPosition()).normalize();if(this._radius>c)this.dot.setPosition(cc.v2(s,a)),e=o.default.SpeedType.NORMAL;else{var p=this._stickPos.x+d.x*this._radius,u=this._stickPos.y+d.y*this._radius;this.dot.setPosition(cc.v2(p,u)),e=o.default.SpeedType.FAST}i.default.getInstance().emit(o.default.JoystickEventType.TOUCH_MOVE,t,{speedType:e,moveDistance:d})},_touchEndEvent:function(t){this.dot.setPosition(this.ring.getPosition()),this.joystickType===o.default.JoystickType.FOLLOW&&(this.node.opacity=0),i.default.getInstance().emit(o.default.JoystickEventType.TOUCH_END,t,{speedType:o.default.SpeedType.STOP})}}),cc._RF.pop()},{JoystickEnum:"JoystickEnum",JoystickEvent:"JoystickEvent"}],Player:[function(t,e){"use strict";cc._RF.push(e,"cb54dsfF4hPHbstG7Fr9wXV","Player");var o=n(t("JoystickEnum")),i=n(t("JoystickEvent"));function n(t){return t&&t.__esModule?t:{default:t}}cc.Class({extends:cc.Component,properties:{moveDir:{default:cc.v2(0,1),displayName:"Move Dir",tooltip:"\u79fb\u52a8\u65b9\u5411"},_speedType:{default:o.default.SpeedType.STOP,displayName:"Speed Type",type:o.default.SpeedType,tooltip:"\u901f\u5ea6\u7ea7\u522b"},_moveSpeed:{default:0,displayName:"Move Speed",tooltip:"\u79fb\u52a8\u901f\u5ea6"},stopSpeed:{default:0,type:cc.Integer,tooltip:"\u505c\u6b62\u65f6\u901f\u5ea6"},normalSpeed:{default:100,type:cc.Integer,tooltip:"\u6b63\u5e38\u901f\u5ea6"},fastSpeed:{default:200,type:cc.Integer,tooltip:"\u6700\u5feb\u901f\u5ea6"},audio_collide:{default:null,type:cc.AudioClip,tooltip:"\u78b0\u649e\u97f3\u6548"},audio_bg:{default:null,type:cc.AudioClip,tooltip:"\u80cc\u666f\u97f3\u4e50"}},onLoad:function(){i.default.getInstance().on(o.default.JoystickEventType.TOUCH_START,this.onTouchStart,this),i.default.getInstance().on(o.default.JoystickEventType.TOUCH_MOVE,this.onTouchMove,this),i.default.getInstance().on(o.default.JoystickEventType.TOUCH_END,this.onTouchEnd,this)},start:function(){this.currentAudio=cc.audioEngine.play(this.audio_bg,!0,1)},onEndContact:function(){this.currentAudio=cc.audioEngine.playEffect(this.audio_collide,!1)},onTouchStart:function(){},onTouchMove:function(t,e){this._speedType=e.speedType,this.moveDir=e.moveDistance},onTouchEnd:function(t,e){this._speedType=e.speedType},move:function(){var t=this.node.getComponent(cc.RigidBody).linearVelocity;t.x=this.moveDir.x*this._moveSpeed/2,t.y=this.moveDir.y*this._moveSpeed/2,this.node.getComponent(cc.RigidBody).linearVelocity=t},update:function(){switch(this._speedType){case o.default.SpeedType.STOP:this._moveSpeed=this.stopSpeed;break;case o.default.SpeedType.NORMAL:this._moveSpeed=this.normalSpeed;break;case o.default.SpeedType.FAST:this._moveSpeed=this.fastSpeed}this.move()}}),cc._RF.pop()},{JoystickEnum:"JoystickEnum",JoystickEvent:"JoystickEvent"}],button:[function(t,e){"use strict";cc._RF.push(e,"202feq11lZJq6c/aCH3HPlr","button"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.on("click",this.ButtonClick,this)},ButtonClick:function(){this.node.opacity=0,this.node.destroy()},start:function(){}}),cc._RF.pop()},{}],camera:[function(t,e){"use strict";cc._RF.push(e,"db0a7f3WttBp4yhBZlMjp+O","camera"),cc.Class({extends:cc.Component,properties:{playerNode:cc.Node},start:function(){},update:function(){if(this.playerNode){var t=this.playerNode.convertToWorldSpaceAR(cc.v2(0,0)),e=this.node.parent.convertToNodeSpaceAR(t);this.node.position=e}}}),cc._RF.pop()},{}],game:[function(t,e){"use strict";cc._RF.push(e,"2c108uDhc9MFo7Cuh+zopoe","game"),cc.Class({extends:cc.Component,properties:{tiledMap:cc.TiledMap},onLoad:function(){var t=cc.director.getPhysicsManager();t.enabled=!0,t.debugDrawFlags=!1,t.gravity=cc.v2(0,0),document.addEventListener("WeixinJSBridgeReady",function(){var t=this;cc.resources.load("audios/rock",cc.AudioClip,function(e,o){var i=t.addComponent(cc.AudioSource);i.clip=o,i.play()})})},start:function(){for(var t=this.tiledMap.getTileSize(),e=this.tiledMap.getLayer("fences"),o=e.getLayerSize(),i=0;i<o.width;i++)for(var n=0;n<o.height;n++){var c=e.getTiledTileAt(i,n,!0);if(0!=c.gid){c.node.group="wall",c.node.addComponent(cc.RigidBody).type=cc.RigidBodyType.Static;var s=c.node.addComponent(cc.PhysicsBoxCollider);s.offset=cc.v2(t.width/2,t.height/2),s.size=t,s.apply()}}}}),cc._RF.pop()},{}]},{},["Joystick","JoystickEnum","JoystickEvent","Player","button","camera","game"]);