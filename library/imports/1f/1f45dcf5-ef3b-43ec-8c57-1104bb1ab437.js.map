{"version":3,"sources":["assets/scripts/bullets.js"],"names":["cc","Class","Component","srcHeight","Number","srcWidth","properties","direction","v2","speed","damage","type","Integer","tooltip","boundaryX","boundaryY","onLoad","view","getCanvasSize","height","width","collider","getComponent","BoxCollider","addComponent","size","node","group","manager","director","getCollisionManager","enabled","start","setDirection","dir","setSpeed","setDamage","onCollisionEnter","other","self","monster","takeDamage","log","destroy","update","dt","newPos","position","add","mul","setPosition","screenSize","getVisibleSize","Math","abs","x","y"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAEAA,EAAE,CAACC,KAAH,CAAS;EACL,WAASD,EAAE,CAACE,SADP;EAGLC,SAAS,EAAEC,MAHN;EAILC,QAAQ,EAAED,MAJL;EAMLE,UAAU,EAAE;IACRC,SAAS,EAAEP,EAAE,CAACQ,EAAH,CAAM,CAAN,EAAS,CAAT,CADH;IAERC,KAAK,EAAE,CAFC;IAGRC,MAAM,EAAE;MACJ,WAAS,EADL;MAEJC,IAAI,EAAEX,EAAE,CAACY,OAFL;MAGJC,OAAO,EAAE;IAHL,CAHA;IAQRC,SAAS,EAAE,GARH;IASRC,SAAS,EAAE;EATH,CANP;EAkBL;EAEAC,MApBK,oBAoBK;IACN,KAAKb,SAAL,GAAiBH,EAAE,CAACiB,IAAH,CAAQC,aAAR,GAAwBC,MAAzC;IACA,KAAKd,QAAL,GAAgBL,EAAE,CAACiB,IAAH,CAAQC,aAAR,GAAwBE,KAAxC,CAFM,CAGN;;IACA,IAAIC,QAAQ,GAAG,KAAKC,YAAL,CAAkBtB,EAAE,CAACuB,WAArB,CAAf;;IACA,IAAI,CAACF,QAAL,EAAe;MACXA,QAAQ,GAAG,KAAKG,YAAL,CAAkBxB,EAAE,CAACuB,WAArB,CAAX;MACAF,QAAQ,CAACI,IAAT,CAAcL,KAAd,GAAsB,KAAKM,IAAL,CAAUN,KAAhC;MACAC,QAAQ,CAACI,IAAT,CAAcN,MAAd,GAAuB,KAAKO,IAAL,CAAUP,MAAjC;IACH,CATK,CAWN;;;IACA,KAAKO,IAAL,CAAUC,KAAV,GAAkB,QAAlB,CAZM,CAcN;;IACA,IAAIC,OAAO,GAAG5B,EAAE,CAAC6B,QAAH,CAAYC,mBAAZ,EAAd;IACAF,OAAO,CAACG,OAAR,GAAkB,IAAlB;EACH,CArCI;EAuCLC,KAvCK,mBAuCI,CAER,CAzCI;EA2CLC,YA3CK,wBA2CQC,GA3CR,EA2Ca;IACd,KAAK3B,SAAL,GAAiB2B,GAAjB;EACH,CA7CI;EA+CLC,QA/CK,oBA+CI1B,KA/CJ,EA+CW;IACZ,KAAKA,KAAL,GAAaA,KAAb;EACH,CAjDI;EAmDL2B,SAnDK,qBAmDK1B,MAnDL,EAmDa;IACd,KAAKA,MAAL,GAAcA,MAAd;EACH,CArDI;EAuDL2B,gBAvDK,4BAuDYC,KAvDZ,EAuDmBC,IAvDnB,EAuDyB;IAC1B,IAAID,KAAK,CAACZ,IAAN,CAAWC,KAAX,KAAqB,SAAzB,EAAoC;MAChC,IAAIa,OAAO,GAAGF,KAAK,CAACZ,IAAN,CAAWJ,YAAX,CAAwB,SAAxB,CAAd;;MACA,IAAIkB,OAAJ,EAAa;QACTA,OAAO,CAACC,UAAR,CAAmB,KAAK/B,MAAxB;QACAV,EAAE,CAAC0C,GAAH,CAAO,cAAP,EAAuB,KAAKhC,MAA5B;MACH,CAL+B,CAMhC;;;MACA,KAAKgB,IAAL,CAAUiB,OAAV;IACH;EACJ,CAjEI;EAmELC,MAnEK,kBAmEGC,EAnEH,EAmEO;IACR;IACA,IAAIC,MAAM,GAAG,KAAKpB,IAAL,CAAUqB,QAAV,CAAmBC,GAAnB,CAAuB,KAAKzC,SAAL,CAAe0C,GAAf,CAAmB,KAAKxC,KAAL,GAAaoC,EAAhC,CAAvB,CAAb;IACA,KAAKnB,IAAL,CAAUwB,WAAV,CAAsBJ,MAAtB,EAHQ,CAKR;;IACA,IAAIK,UAAU,GAAGnD,EAAE,CAACiB,IAAH,CAAQmC,cAAR,EAAjB;;IACA,IAAIC,IAAI,CAACC,GAAL,CAAS,KAAK5B,IAAL,CAAU6B,CAAnB,IAAwBJ,UAAU,CAAC/B,KAAX,GAAiB,CAAzC,IAA8CiC,IAAI,CAACC,GAAL,CAAS,KAAK5B,IAAL,CAAU8B,CAAnB,IAAwBL,UAAU,CAAChC,MAAX,GAAkB,CAA5F,EAA+F;MAC3F,KAAKO,IAAL,CAAUiB,OAAV;IACH;EACJ;AA7EI,CAAT","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    srcHeight: Number,\n    srcWidth: Number,\n\n    properties: {\n        direction: cc.v2(0, 1),\n        speed: 0,\n        damage: {\n            default: 20,\n            type: cc.Integer,\n            tooltip: '子弹伤害值'\n        },\n        boundaryX: 480,\n        boundaryY: 960\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.srcHeight = cc.view.getCanvasSize().height;\n        this.srcWidth = cc.view.getCanvasSize().width;\n        // 添加碰撞体\n        let collider = this.getComponent(cc.BoxCollider);\n        if (!collider) {\n            collider = this.addComponent(cc.BoxCollider);\n            collider.size.width = this.node.width;\n            collider.size.height = this.node.height;\n        }\n        \n        // 设置碰撞组\n        this.node.group = 'bullet';\n        \n        // 启用碰撞检测系统\n        let manager = cc.director.getCollisionManager();\n        manager.enabled = true;\n    },\n\n    start () {\n\n    },\n\n    setDirection(dir) {\n        this.direction = dir;\n    },\n\n    setSpeed(speed) {\n        this.speed = speed;\n    },\n\n    setDamage(damage) {\n        this.damage = damage;\n    },\n\n    onCollisionEnter(other, self) {\n        if (other.node.group === 'monster') {\n            let monster = other.node.getComponent('Monster');\n            if (monster) {\n                monster.takeDamage(this.damage);\n                cc.log('子弹击中怪物！造成伤害:', this.damage);\n            }\n            // 销毁子弹\n            this.node.destroy();\n        }\n    },\n\n    update (dt) {\n        // 移动子弹\n        let newPos = this.node.position.add(this.direction.mul(this.speed * dt));\n        this.node.setPosition(newPos);\n        \n        // 如果子弹超出屏幕范围，销毁子弹\n        let screenSize = cc.view.getVisibleSize();\n        if (Math.abs(this.node.x) > screenSize.width/2 || Math.abs(this.node.y) > screenSize.height/2) {\n            this.node.destroy();\n        }\n    }\n});\n"]}