{"version":3,"sources":["assets/scripts/Player.js"],"names":["cc","Class","Component","properties","moveDir","v2","displayName","tooltip","_speedType","JoystickEnum","SpeedType","STOP","type","_moveSpeed","stopSpeed","Integer","normalSpeed","fastSpeed","audio_collide","AudioClip","audio_bg","bulletPre","Prefab","shootInterval","Float","onLoad","JoystickEvent","getInstance","on","JoystickEventType","TOUCH_START","onTouchStart","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","start","currentAudio","audioEngine","play","schedule","shoot","bullet","instantiate","x","node","width","y","setParent","director","getScene","onEndContact","contact","selfCollider","otherCollider","playEffect","event","data","speedType","moveDistance","move","lv","getComponent","RigidBody","linearVelocity","update","dt","NORMAL","FAST"],"mappings":"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","sourceRoot":"/","sourcesContent":["import JoystickEnum from \"JoystickEnum\";\nimport JoystickEvent from \"JoystickEvent\";\n\ncc.Class({\n    extends: cc.Component,\n    properties: {\n\n        // from joystick\n        moveDir: {\n            default: cc.v2(0, 1),\n            displayName: 'Move Dir',\n            tooltip: '移动方向',\n        },\n        _speedType: {\n            default: JoystickEnum.SpeedType.STOP,\n            displayName: 'Speed Type',\n            type: JoystickEnum.SpeedType,\n            tooltip: '速度级别'\n        },\n\n        // from self\n        _moveSpeed: {\n            default: 0,\n            displayName: 'Move Speed',\n            tooltip: '移动速度'\n        },\n\n        stopSpeed: {\n            default: 0,\n            type: cc.Integer,\n            tooltip: '停止时速度'\n        },\n        normalSpeed: {\n            default: 100,\n            type: cc.Integer,\n            tooltip: '正常速度'\n        },\n        fastSpeed: {\n            default: 200,\n            type: cc.Integer,\n            tooltip: '最快速度'\n        },\n        audio_collide: {\n            default: null,\n            type: cc.AudioClip,\n            tooltip: '碰撞音效'\n        },\n        audio_bg: {\n            default: null,\n            type: cc.AudioClip,\n            tooltip: '背景音乐'\n        },\n        bulletPre: {\n            default: null,\n            type: cc.Prefab,\n        },\n        shootInterval: {\n            default: 0.5,\n            type: cc.Float,\n        },\n\n    },\n\n    onLoad() {\n        JoystickEvent.getInstance().on(JoystickEnum.JoystickEventType.TOUCH_START, this.onTouchStart, this);\n        JoystickEvent.getInstance().on(JoystickEnum.JoystickEventType.TOUCH_MOVE, this.onTouchMove, this);\n        JoystickEvent.getInstance().on(JoystickEnum.JoystickEventType.TOUCH_END, this.onTouchEnd, this);\n    },\n\n    start() {\n        this.currentAudio = cc.audioEngine.play(this.audio_bg, true, 1);\n        this.schedule(()=>{this.shoot()}, this.shootInterval);\n    },\n\n    shoot() {\n        let bullet = cc.instantiate(this.bulletPre);\n        bullet.x = 240 + this.node.x + this.node.width/2;\n        bullet.y = 480 + this.node.y;\n        bullet.setParent(cc.director.getScene());\n    },\n\n\n    onEndContact: function (contact, selfCollider, otherCollider) {\n        //play sound effect\n        this.currentAudio = cc.audioEngine.playEffect(this.audio_collide, false);\n    },\n\n    onTouchStart() {\n\n    },\n\n    onTouchMove(event, data) {\n        this._speedType = data.speedType;\n        this.moveDir = data.moveDistance;\n    },\n\n    onTouchEnd(event, data) {\n        this._speedType = data.speedType;\n    },\n\n    // methods\n    move() {\n        // this.node.angle = cc.misc.radiansToDegrees(\n        //     Math.atan2(this.moveDir.y, this.moveDir.x)\n        // ) - 90;\n        //let newPos = this.node.position.add(this.moveDir.mul(this._moveSpeed / 120));\n        //this.node.setPosition(newPos);\n        let lv = this.node.getComponent(cc.RigidBody).linearVelocity;\n        //console.log(this._moveSpeed);\n        lv.x  = this.moveDir.x * this._moveSpeed / 2;\n        lv.y  = this.moveDir.y * this._moveSpeed / 2;\n        this.node.getComponent(cc.RigidBody).linearVelocity = lv;\n    },\n\n    update(dt) {\n        switch (this._speedType) {\n            case JoystickEnum.SpeedType.STOP:\n                this._moveSpeed = this.stopSpeed;\n                break;\n            case JoystickEnum.SpeedType.NORMAL:\n                this._moveSpeed = this.normalSpeed;\n                break;\n            case JoystickEnum.SpeedType.FAST:\n                this._moveSpeed = this.fastSpeed;\n                break;\n            default:\n                break;\n        }\n        this.move();\n    },\n});\n"]}