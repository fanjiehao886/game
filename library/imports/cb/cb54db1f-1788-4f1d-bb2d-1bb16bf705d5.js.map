{"version":3,"sources":["assets/scripts/Player.js"],"names":["cc","Class","Component","properties","moveDir","v2","displayName","tooltip","_speedType","JoystickEnum","SpeedType","STOP","type","_moveSpeed","stopSpeed","Integer","normalSpeed","fastSpeed","audio_collide","AudioClip","audio_bg","onLoad","JoystickEvent","getInstance","on","JoystickEventType","TOUCH_START","onTouchStart","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","start","currentAudio","audioEngine","play","onEndContact","contact","selfCollider","otherCollider","playEffect","event","data","speedType","moveDistance","move","lv","node","getComponent","RigidBody","linearVelocity","x","y","update","dt","NORMAL","FAST"],"mappings":"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","sourceRoot":"/","sourcesContent":["import JoystickEnum from \"JoystickEnum\";\nimport JoystickEvent from \"JoystickEvent\";\n\ncc.Class({\n    extends: cc.Component,\n    properties: {\n\n        // from joystick\n        moveDir: {\n            default: cc.v2(0, 1),\n            displayName: 'Move Dir',\n            tooltip: '移动方向',\n        },\n        _speedType: {\n            default: JoystickEnum.SpeedType.STOP,\n            displayName: 'Speed Type',\n            type: JoystickEnum.SpeedType,\n            tooltip: '速度级别'\n        },\n\n        // from self\n        _moveSpeed: {\n            default: 0,\n            displayName: 'Move Speed',\n            tooltip: '移动速度'\n        },\n\n        stopSpeed: {\n            default: 0,\n            type: cc.Integer,\n            tooltip: '停止时速度'\n        },\n        normalSpeed: {\n            default: 100,\n            type: cc.Integer,\n            tooltip: '正常速度'\n        },\n        fastSpeed: {\n            default: 200,\n            type: cc.Integer,\n            tooltip: '最快速度'\n        },\n        audio_collide: {\n            default: null,\n            type: cc.AudioClip,\n            tooltip: '碰撞音效'\n        },\n        audio_bg: {\n            default: null,\n            type: cc.AudioClip,\n            tooltip: '背景音乐'\n        }\n\n    },\n\n    onLoad() {\n        JoystickEvent.getInstance().on(JoystickEnum.JoystickEventType.TOUCH_START, this.onTouchStart, this);\n        JoystickEvent.getInstance().on(JoystickEnum.JoystickEventType.TOUCH_MOVE, this.onTouchMove, this);\n        JoystickEvent.getInstance().on(JoystickEnum.JoystickEventType.TOUCH_END, this.onTouchEnd, this);\n    },\n\n    start() {\n        this.currentAudio = cc.audioEngine.play(this.audio_bg, true, 1);\n    },\n\n\n    onEndContact: function (contact, selfCollider, otherCollider) {\n        //play sound effect\n        this.currentAudio = cc.audioEngine.playEffect(this.audio_collide, false);\n    },\n\n    onTouchStart() {\n\n    },\n\n    onTouchMove(event, data) {\n        this._speedType = data.speedType;\n        this.moveDir = data.moveDistance;\n    },\n\n    onTouchEnd(event, data) {\n        this._speedType = data.speedType;\n    },\n\n    // methods\n    move() {\n        // this.node.angle = cc.misc.radiansToDegrees(\n        //     Math.atan2(this.moveDir.y, this.moveDir.x)\n        // ) - 90;\n        //let newPos = this.node.position.add(this.moveDir.mul(this._moveSpeed / 120));\n        //this.node.setPosition(newPos);\n        let lv = this.node.getComponent(cc.RigidBody).linearVelocity;\n        //console.log(this._moveSpeed);\n        lv.x  = this.moveDir.x * this._moveSpeed / 2;\n        lv.y  = this.moveDir.y * this._moveSpeed / 2;\n        this.node.getComponent(cc.RigidBody).linearVelocity = lv;\n    },\n\n    update(dt) {\n        switch (this._speedType) {\n            case JoystickEnum.SpeedType.STOP:\n                this._moveSpeed = this.stopSpeed;\n                break;\n            case JoystickEnum.SpeedType.NORMAL:\n                this._moveSpeed = this.normalSpeed;\n                break;\n            case JoystickEnum.SpeedType.FAST:\n                this._moveSpeed = this.fastSpeed;\n                break;\n            default:\n                break;\n        }\n        this.move();\n    },\n});\n"]}