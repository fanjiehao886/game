{"version":3,"sources":["assets/scripts/Coin.js"],"names":["cc","Class","Component","properties","targetPosition","Vec2","flyDuration","coinValue","onLoad","node","touchable","on","Node","EventType","TOUCH_START","onCollect","collider","getComponent","BoxCollider","addComponent","size","worldPos","parent","convertToWorldSpaceAR","position","targetWorldPos","GoldManager","instance","getWorldPosition","log","uiPos","convertToNodeSpaceAR","tween","to","scale","call","find","addGold","destroy","start"],"mappings":";;;;;;AAAA;;;;AAEAA,EAAE,CAACC,KAAH,CAAS;EACL,WAASD,EAAE,CAACE,SADP;EAGLC,UAAU,EAAE;IACRC,cAAc,EAAEJ,EAAE,CAACK,IADX;IAERC,WAAW,EAAE,GAFL;IAGRC,SAAS,EAAE;EAHH,CAHP;EASLC,MATK,oBASI;IACL;IACA,KAAKC,IAAL,CAAUC,SAAV,GAAsB,IAAtB;IACA,KAAKD,IAAL,CAAUE,EAAV,CAAaX,EAAE,CAACY,IAAH,CAAQC,SAAR,CAAkBC,WAA/B,EAA4C,KAAKC,SAAjD,EAA4D,IAA5D,EAHK,CAKL;;IACA,IAAIC,QAAQ,GAAG,KAAKC,YAAL,CAAkBjB,EAAE,CAACkB,WAArB,KAAqC,KAAKC,YAAL,CAAkBnB,EAAE,CAACkB,WAArB,CAApD;IACAF,QAAQ,CAACI,IAAT,GAAgBpB,EAAE,CAACoB,IAAH,CAAQ,EAAR,EAAY,EAAZ,CAAhB;EACH,CAjBI;EAmBLL,SAnBK,uBAmBO;IAAA;;IACR,IAAMM,QAAQ,GAAG,KAAKZ,IAAL,CAAUa,MAAV,CAAiBC,qBAAjB,CAAuC,KAAKd,IAAL,CAAUe,QAAjD,CAAjB;;IACA,IAAMC,cAAc,GAAGC,uBAAA,CAAYC,QAAZ,CAAqBC,gBAArB,EAAvB;;IACA5B,EAAE,CAAC6B,GAAH,4CAAkBR,QAAlB,4DAAyCI,cAAzC;IACA,IAAMK,KAAK,GAAG,KAAKrB,IAAL,CAAUa,MAAV,CAAiBS,oBAAjB,CAAsCN,cAAtC,CAAd;IAEAzB,EAAE,CAACgC,KAAH,CAAS,KAAKvB,IAAd,EACKwB,EADL,CACQ,KAAK3B,WADb,EAC0B;MAClBkB,QAAQ,EAAEM,KADQ;MAElBI,KAAK,EAAE;IAFW,CAD1B,EAKKC,IALL,CAKU,YAAM;MACRnC,EAAE,CAACoC,IAAH,CAAQ,yBAAR,EAAmCnB,YAAnC,CAAgD,aAAhD,EAA+DoB,OAA/D,CAAuE,KAAI,CAAC9B,SAA5E;;MACA,KAAI,CAACE,IAAL,CAAU6B,OAAV;IACH,CARL,EASKC,KATL;EAUH;AAnCI,CAAT","sourceRoot":"/","sourcesContent":["import GoldManager from './GoldManager';\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        targetPosition: cc.Vec2,\n        flyDuration: 0.5,\n        coinValue: 1\n    },\n\n    onLoad() {\n        // 启用触摸并设置点击区域\n        this.node.touchable = true;\n        this.node.on(cc.Node.EventType.TOUCH_START, this.onCollect, this);\n        \n        // 添加碰撞组件确保点击区域有效\n        let collider = this.getComponent(cc.BoxCollider) || this.addComponent(cc.BoxCollider);\n        collider.size = cc.size(40, 40);\n    },\n\n    onCollect() {\n        const worldPos = this.node.parent.convertToWorldSpaceAR(this.node.position);\n        const targetWorldPos = GoldManager.instance.getWorldPosition();\n        cc.log(`金币世界坐标: ${worldPos}, 目标节点实时坐标: ${targetWorldPos}`);\n        const uiPos = this.node.parent.convertToNodeSpaceAR(targetWorldPos);\n        \n        cc.tween(this.node)\n            .to(this.flyDuration, { \n                position: uiPos,\n                scale: 0.3\n            })\n            .call(() => {\n                cc.find('Canvas/UI/GoldenManager').getComponent('GoldManager').addGold(this.coinValue);\n                this.node.destroy();\n            })\n            .start();\n    }\n});"]}