{"version":3,"sources":["assets\\scripts\\Player.js"],"names":["_JoystickEnum","_interopRequireDefault","require","_JoystickEvent","obj","__esModule","cc","Class","Component","properties","moveDir","v2","displayName","tooltip","_speedType","JoystickEnum","SpeedType","STOP","type","_moveSpeed","stopSpeed","Integer","normalSpeed","fastSpeed","audio_collide","AudioClip","audio_bg","bulletPre","Prefab","shootInterval","Float","onLoad","JoystickEvent","getInstance","on","JoystickEventType","TOUCH_START","onTouchStart","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","start","_this","currentAudio","audioEngine","play","schedule","shoot","bullet","instantiate","x","node","width","y","setParent","director","getScene","onEndContact","contact","selfCollider","otherCollider","playEffect","event","data","speedType","moveDistance","move","lv","getComponent","RigidBody","linearVelocity","update","dt","NORMAL","FAST"],"mappings":"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","sourceRoot":"/","sourcesContent":["import JoystickEnum from \"JoystickEnum\";\r\nimport JoystickEvent from \"JoystickEvent\";\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n\r\n        // from joystick\r\n        moveDir: {\r\n            default: cc.v2(0, 1),\r\n            displayName: 'Move Dir',\r\n            tooltip: '移动方向',\r\n        },\r\n        _speedType: {\r\n            default: JoystickEnum.SpeedType.STOP,\r\n            displayName: 'Speed Type',\r\n            type: JoystickEnum.SpeedType,\r\n            tooltip: '速度级别'\r\n        },\r\n\r\n        // from self\r\n        _moveSpeed: {\r\n            default: 0,\r\n            displayName: 'Move Speed',\r\n            tooltip: '移动速度'\r\n        },\r\n\r\n        stopSpeed: {\r\n            default: 0,\r\n            type: cc.Integer,\r\n            tooltip: '停止时速度'\r\n        },\r\n        normalSpeed: {\r\n            default: 100,\r\n            type: cc.Integer,\r\n            tooltip: '正常速度'\r\n        },\r\n        fastSpeed: {\r\n            default: 200,\r\n            type: cc.Integer,\r\n            tooltip: '最快速度'\r\n        },\r\n        audio_collide: {\r\n            default: null,\r\n            type: cc.AudioClip,\r\n            tooltip: '碰撞音效'\r\n        },\r\n        audio_bg: {\r\n            default: null,\r\n            type: cc.AudioClip,\r\n            tooltip: '背景音乐'\r\n        },\r\n        bulletPre: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        shootInterval: {\r\n            default: 0.5,\r\n            type: cc.Float,\r\n        },\r\n\r\n    },\r\n\r\n    onLoad() {\r\n        JoystickEvent.getInstance().on(JoystickEnum.JoystickEventType.TOUCH_START, this.onTouchStart, this);\r\n        JoystickEvent.getInstance().on(JoystickEnum.JoystickEventType.TOUCH_MOVE, this.onTouchMove, this);\r\n        JoystickEvent.getInstance().on(JoystickEnum.JoystickEventType.TOUCH_END, this.onTouchEnd, this);\r\n    },\r\n\r\n    start() {\r\n        this.currentAudio = cc.audioEngine.play(this.audio_bg, true, 1);\r\n        this.schedule(()=>{this.shoot()}, this.shootInterval);\r\n    },\r\n\r\n    shoot() {\r\n        let bullet = cc.instantiate(this.bulletPre);\r\n        bullet.x = 240 + this.node.x + this.node.width/2;\r\n        bullet.y = 480 + this.node.y;\r\n        bullet.setParent(cc.director.getScene());\r\n    },\r\n\r\n\r\n    onEndContact: function (contact, selfCollider, otherCollider) {\r\n        //play sound effect\r\n        this.currentAudio = cc.audioEngine.playEffect(this.audio_collide, false);\r\n    },\r\n\r\n    onTouchStart() {\r\n\r\n    },\r\n\r\n    onTouchMove(event, data) {\r\n        this._speedType = data.speedType;\r\n        this.moveDir = data.moveDistance;\r\n    },\r\n\r\n    onTouchEnd(event, data) {\r\n        this._speedType = data.speedType;\r\n    },\r\n\r\n    // methods\r\n    move() {\r\n        // this.node.angle = cc.misc.radiansToDegrees(\r\n        //     Math.atan2(this.moveDir.y, this.moveDir.x)\r\n        // ) - 90;\r\n        //let newPos = this.node.position.add(this.moveDir.mul(this._moveSpeed / 120));\r\n        //this.node.setPosition(newPos);\r\n        let lv = this.node.getComponent(cc.RigidBody).linearVelocity;\r\n        //console.log(this._moveSpeed);\r\n        lv.x  = this.moveDir.x * this._moveSpeed / 2;\r\n        lv.y  = this.moveDir.y * this._moveSpeed / 2;\r\n        this.node.getComponent(cc.RigidBody).linearVelocity = lv;\r\n    },\r\n\r\n    update(dt) {\r\n        switch (this._speedType) {\r\n            case JoystickEnum.SpeedType.STOP:\r\n                this._moveSpeed = this.stopSpeed;\r\n                break;\r\n            case JoystickEnum.SpeedType.NORMAL:\r\n                this._moveSpeed = this.normalSpeed;\r\n                break;\r\n            case JoystickEnum.SpeedType.FAST:\r\n                this._moveSpeed = this.fastSpeed;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        this.move();\r\n    },\r\n});\r\n"]}