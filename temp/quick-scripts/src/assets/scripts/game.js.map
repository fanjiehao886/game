{"version":3,"sources":["assets/scripts/game.js"],"names":["cc","Class","Component","properties","tiledMap","TiledMap","onLoad","p","director","getPhysicsManager","enabled","debugDrawFlags","gravity","v2","document","addEventListener","resources","load","AudioClip","err","audioClip","audioSource","addComponent","AudioSource","clip","play","start","tiledSize","getTileSize","layer","getLayer","layerSize","getLayerSize","i","width","j","height","tiled","getTiledTileAt","gid","node","group","body","RigidBody","type","RigidBodyType","Static","collider","PhysicsBoxCollider","offset","size","apply"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAGAA,EAAE,CAACC,KAAH,CAAS;EACL,WAASD,EAAE,CAACE,SADP;EAGLC,UAAU,EAAE;IACRC,QAAQ,EAAEJ,EAAE,CAACK;EADL,CAHP;EAOL;EAEAC,MATK,oBASK;IACN,IAAIC,CAAC,GAAGP,EAAE,CAACQ,QAAH,CAAYC,iBAAZ,EAAR;IACAF,CAAC,CAACG,OAAF,GAAY,IAAZ;IACAH,CAAC,CAACI,cAAF,GAAmB,KAAnB;IACAJ,CAAC,CAACK,OAAF,GAAYZ,EAAE,CAACa,EAAH,CAAM,CAAN,EAAQ,CAAR,CAAZ;IAEAC,QAAQ,CAACC,gBAAT,CAA0B,qBAA1B,EAAiD,YAAY;MAAA;;MACzDf,EAAE,CAACgB,SAAH,CAAaC,IAAb,CAAkB,aAAlB,EAAiCjB,EAAE,CAACkB,SAApC,EAA+C,UAACC,GAAD,EAAMC,SAAN,EAAoB;QAC/D,IAAIC,WAAW,GAAG,KAAI,CAACC,YAAL,CAAkBtB,EAAE,CAACuB,WAArB,CAAlB;;QACAF,WAAW,CAACG,IAAZ,GAAmBJ,SAAnB;QACAC,WAAW,CAACI,IAAZ;MACH,CAJD;IAKH,CAND;EAOH,CAtBI;EAwBLC,KAxBK,mBAwBI;IACL,IAAIC,SAAS,GAAG,KAAKvB,QAAL,CAAcwB,WAAd,EAAhB;IACA,IAAIC,KAAK,GAAG,KAAKzB,QAAL,CAAc0B,QAAd,CAAuB,QAAvB,CAAZ;IACA,IAAIC,SAAS,GAAGF,KAAK,CAACG,YAAN,EAAhB;;IAEA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,SAAS,CAACG,KAA9B,EAAqCD,CAAC,EAAtC,EAA0C;MACtC,KAAI,IAAIE,CAAC,GAAC,CAAV,EAAaA,CAAC,GAACJ,SAAS,CAACK,MAAzB,EAAiCD,CAAC,EAAlC,EAAqC;QACjC,IAAIE,KAAK,GAAGR,KAAK,CAACS,cAAN,CAAqBL,CAArB,EAAwBE,CAAxB,EAA2B,IAA3B,CAAZ;;QACA,IAAGE,KAAK,CAACE,GAAN,IAAa,CAAhB,EAAkB;UACdF,KAAK,CAACG,IAAN,CAAWC,KAAX,GAAmB,MAAnB;UACA,IAAIC,IAAI,GAAGL,KAAK,CAACG,IAAN,CAAWlB,YAAX,CAAwBtB,EAAE,CAAC2C,SAA3B,CAAX;UACAD,IAAI,CAACE,IAAL,GAAY5C,EAAE,CAAC6C,aAAH,CAAiBC,MAA7B;UACA,IAAIC,QAAQ,GAAGV,KAAK,CAACG,IAAN,CAAWlB,YAAX,CAAwBtB,EAAE,CAACgD,kBAA3B,CAAf;UACAD,QAAQ,CAACE,MAAT,GAAkBjD,EAAE,CAACa,EAAH,CAAMc,SAAS,CAACO,KAAV,GAAgB,CAAtB,EAAyBP,SAAS,CAACS,MAAV,GAAiB,CAA1C,CAAlB;UACAW,QAAQ,CAACG,IAAT,GAAgBvB,SAAhB;UACAoB,QAAQ,CAACI,KAAT;QACH;MACJ;IACJ;EAEJ,CA5CI,CA8CL;;AA9CK,CAAT","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        tiledMap: cc.TiledMap\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        let p = cc.director.getPhysicsManager();\n        p.enabled = true;\n        p.debugDrawFlags = false;\n        p.gravity = cc.v2(0,0);\n\n        document.addEventListener('WeixinJSBridgeReady', function () {\n            cc.resources.load('audios/rock', cc.AudioClip, (err, audioClip) => {\n                var audioSource = this.addComponent(cc.AudioSource);\n                audioSource.clip = audioClip;\n                audioSource.play();\n            });\n        });\n    },\n\n    start () {\n        let tiledSize = this.tiledMap.getTileSize();\n        let layer = this.tiledMap.getLayer('fences');\n        let layerSize = layer.getLayerSize();\n\n        for (let i = 0; i < layerSize.width; i++) {\n            for(let j=0; j<layerSize.height; j++){\n                let tiled = layer.getTiledTileAt(i, j, true);\n                if(tiled.gid != 0){\n                    tiled.node.group = 'wall';\n                    let body = tiled.node.addComponent(cc.RigidBody);\n                    body.type = cc.RigidBodyType.Static;\n                    let collider = tiled.node.addComponent(cc.PhysicsBoxCollider);\n                    collider.offset = cc.v2(tiledSize.width/2, tiledSize.height/2);\n                    collider.size = tiledSize;\n                    collider.apply();\n                }\n            }\n        }\n\n    },\n\n    // update (dt) {},\n});\n"]}